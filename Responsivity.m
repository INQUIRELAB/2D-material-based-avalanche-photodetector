%% 3D plot: Responsivity (Z) vs Wavelength (X) and Electric Field (Y)
% - Added 0V–10V electric-field values (Y-axis) and corresponding responsivity rows (Z-axis)
% - Keeps all provided data as-is
% - Nature-style look (Helvetica/Arial, no bold, clean box)
% - Wavelength axis displayed in micrometers (µm) so no ×10^-6 on ticks
% - X/Y labels auto-aligned parallel to axes (like Z label)
% - Vector PDF export
% - NO black overlay lines on the surface

clear; clc; close all;

%% X axis: wavelength (given)
Ida0 = [ ...
    8.0000e-6, 7.8000e-6, 7.6000e-6, 7.4000e-6, 7.2000e-6, ...
    7.0000e-6, 6.8000e-6, 6.6000e-6, 6.4000e-6, 6.2000e-6, ...
    6.0000e-6, 5.8000e-6, 5.6000e-6, 5.4000e-6, 5.2000e-6, ...
    5.0000e-6, 4.8000e-6, 4.6000e-6, 4.4000e-6, 4.2000e-6, ...
    4.0000e-6, 3.8000e-6, 3.6000e-6, 3.4000e-6, 3.2000e-6, ...
    3.0000e-6 ];

%% Y axis: electric field (added 0V–10V + existing 11V–21V)
y_0V  = 0.9;
y_1V  = 1.199;
y_2V  = 1.477;
y_3V  = 1.7;
y_4V  = 1.98;
y_5V  = 2.25;
y_6V  = 2.53;
y_7V  = 2.89;
y_8V  = 3.18;
y_9V  = 3.46;
y_10V = 3.74;

y_11V = 4.02;
y_12V = 4.30;
y_13V = 4.58;
y_14V = 4.86;
y_15V = 5.13;
y_16V = 5.40;
y_17V = 5.68;
y_18V = 5.95;
y_19V = 6.22;
y_20V = 6.49;
y_21V = 6.75;

%% Z axis: responsivity (rows must match length(Ida0)=26)
z_0V  = [2.1362,2.1050,2.0649,2.0277,1.9894,1.9574,1.9303,1.8976,1.8726,1.8461,1.8208,1.8038,1.7846,1.7584,1.7394,1.7356,1.7144,1.7007,1.6880,1.6765,1.6636,1.6525,1.6491,3.9020,2.9920,2.7972];
z_1V  = [2.3743,2.3732,2.3566,2.3380,2.3236,2.3066,2.2908,2.2738,2.2558,2.2387,2.2229,2.2305,2.2039,2.1834,2.1682,2.1506,2.1354,2.1241,2.1093,2.1012,2.0882,2.0752,2.0687,5.1244,3.7349,3.4939];
z_2V  = [2.5456,2.5212,2.5124,2.5102,2.5079,2.5042,2.4978,2.4941,2.4895,2.4840,2.5618,2.5297,2.4973,2.4802,2.4630,2.4464,2.4411,2.4320,2.4246,2.4191,2.4087,2.3980,2.3980,6.2006,4.2917,4.0335];
z_3V  = [2.6474,2.6567,2.6509,2.6496,2.6510,2.6532,2.6490,2.6511,2.6548,2.6498,2.6524,2.7051,2.6851,2.6705,2.6646,2.6533,2.6515,2.6480,2.6466,2.6416,2.6439,2.6336,2.6312,7.0685,4.6636,4.4044];
z_4V  = [2.7709,2.7871,2.7869,2.7962,2.7985,2.8001,2.8037,2.8076,2.8097,2.8125,2.8149,2.8738,2.8570,2.8415,2.8366,2.8332,2.8267,2.8268,2.8296,2.8251,2.8283,2.8251,2.8271,7.8118,4.9257,4.6698];
z_5V  = [2.9183,2.9362,2.9440,2.9483,2.9577,2.9594,2.9624,2.9662,2.9772,2.9790,2.9834,2.9854,3.0411,3.0199,3.0130,3.0092,3.0085,3.0052,3.0058,3.0060,3.0060,3.0035,3.0045,8.5176,5.1603,4.9030];
z_6V  = [3.0930,3.1063,3.1182,3.1270,3.1349,3.1451,3.1475,3.1552,3.1603,3.1654,3.1697,3.1733,3.1760,3.2231,3.2135,3.2058,3.2010,3.2012,3.1932,3.1962,3.1959,3.1993,3.2011,9.2280,5.3893,5.1490];
z_7V  = [3.2775,3.2974,3.3105,3.3224,3.3349,3.3432,3.3547,3.3614,3.3670,3.3732,3.3792,3.3856,3.3903,3.3935,3.3971,3.4013,3.4043,3.4076,3.4115,3.4142,3.4166,3.4181,3.4160,9.9594,5.6428,5.4110];
z_8V  = [3.5468,3.5063,3.5245,3.5424,3.5565,3.5735,3.5846,3.5958,3.6025,3.6098,3.6171,3.6228,3.6303,3.6349,3.6392,3.6440,3.6492,3.6528,3.6581,3.6604,3.6630,3.6655,3.6688,10.716,5.9132,5.7000];
z_9V  = [3.7097,3.7540,3.7774,3.7924,3.8077,3.8270,3.8411,3.8555,3.8662,3.8745,3.8854,3.8955,3.9021,3.9096,3.9165,3.9229,3.9285,3.9337,3.9382,3.9431,3.9462,3.9503,3.9541,11.495,6.2220,6.0307];
z_10V = [3.9693,4.0301,4.0487,4.0745,4.0962,4.1170,4.1345,4.1523,4.1721,4.1845,4.1924,4.2064,4.2179,4.2270,4.2390,4.2440,4.2508,4.2586,4.2662,4.2683,4.2737,4.2803,4.2838,12.303,6.5837,6.4070];

z_11V = [4.2559,4.3533,4.3760,4.4071,4.4350,4.4597,4.4851,4.5038,4.5211,4.5396,4.5584,4.5720,4.5825,4.5967,4.6093,4.6204,4.6296,4.6364,4.6443,4.6517,4.6586,4.6643,4.6694,13.150,6.9916,6.8358];
z_12V = [4.5836,4.7338,4.7539,4.7861,4.8233,4.8543,4.8888,4.9133,4.9326,4.9612,4.9792,4.9997,5.0149,5.0333,5.0478,5.0613,5.0729,5.0841,5.0944,5.1051,5.1119,5.1187,5.1287,14.042,7.4679,7.3397];
z_13V = [4.9707,5.1769,5.2097,5.2414,5.2835,5.3232,5.3589,5.3931,5.4294,5.4611,5.4837,5.5118,5.5368,5.5536,5.5756,5.5899,5.6054,5.6191,5.6319,5.6451,5.6556,5.6658,5.6738,14.988,8.0412,7.9344];
z_14V = [5.4171,5.7175,5.7409,5.7847,5.8332,5.8814,5.9325,5.9780,6.0231,6.0592,6.0908,6.1259,6.1576,6.1869,6.2102,6.2326,6.2507,6.2706,6.2886,6.3022,6.3149,6.3295,6.3408,16.008,8.7304,8.6523];
z_15V = [5.9472,6.0905,6.2220,6.4417,6.5043,6.5652,6.6299,6.6883,6.7447,6.7953,6.8427,6.8843,6.9279,6.9638,6.9927,7.0226,7.0496,7.0727,7.0961,7.1154,7.1327,7.1489,7.1630,17.135,9.5763,9.5225];
z_16V = [6.5717,6.7732,6.9470,7.1019,7.2355,7.4077,7.4911,7.5749,7.6502,7.7169,7.7793,7.8361,7.8869,7.9394,7.9774,8.0154,8.0487,8.0800,8.1071,8.1322,8.1551,8.1748,8.1930,18.390,10.632,10.616];
z_17V = [7.3385,7.6109,7.8432,8.0484,8.2359,8.3943,8.5937,8.6971,8.7989,8.8940,8.9777,9.0492,9.1194,9.1750,9.2323,9.2807,9.3227,9.3605,9.3973,9.4281,9.4560,9.4808,9.5028,19.846,11.975,11.984];
z_18V = [8.2918,8.6606,8.9770,9.2634,9.5183,9.7401,10.004,10.153,10.261,10.394,10.511,10.616,10.708,10.788,10.859,10.922,10.977,11.027,11.069,11.106,11.139,11.168,11.192,21.563,13.685,13.734];
z_19V = [9.5063,10.006,10.457,10.857,11.207,11.516,11.787,12.020,12.226,12.408,12.564,12.702,12.818,12.920,13.009,13.085,13.151,13.208,13.259,13.304,13.338,13.371,13.398,23.663,15.906,15.987];
z_20V = [11.084,11.800,12.437,12.999,13.494,13.918,14.292,14.612,14.888,15.124,15.325,15.493,15.641,15.764,15.868,15.955,16.028,16.087,16.139,16.181,16.215,16.242,16.265,26.278,18.779,18.887];
z_21V = [13.207,14.233,15.143,15.943,16.635,17.226,17.725,18.150,18.504,18.802,19.045,19.250,19.417,19.553,19.663,19.750,19.819,19.872,19.913,19.943,19.963,19.973,19.983,29.583,22.473,22.617];

%% Build matrices
x_um = Ida0(:).' * 1e6;   % show wavelength in micrometers (removes ×10^-6)

y = [ ...
    y_0V y_1V y_2V y_3V y_4V y_5V y_6V y_7V y_8V y_9V y_10V ...
    y_11V y_12V y_13V y_14V y_15V y_16V y_17V y_18V y_19V y_20V y_21V];

Z = [
    z_0V(:).';
    z_1V(:).';
    z_2V(:).';
    z_3V(:).';
    z_4V(:).';
    z_5V(:).';
    z_6V(:).';
    z_7V(:).';
    z_8V(:).';
    z_9V(:).';
    z_10V(:).';
    z_11V(:).';
    z_12V(:).';
    z_13V(:).';
    z_14V(:).';
    z_15V(:).';
    z_16V(:).';
    z_17V(:).';
    z_18V(:).';
    z_19V(:).';
    z_20V(:).';
    z_21V(:).'
];

[X, Y] = meshgrid(x_um, y);

%% -------------------- Nature-style plotting --------------------
fontName = 'Helvetica';
if ~any(strcmp(listfonts, fontName))
    fontName = 'Arial';
end

side = 6; % inches
figure('Color','w','Units','inches','Position',[1 1 side side]);

% Smooth surface WITHOUT mesh edges
hSurf = surf(X, Y, Z);
hSurf.EdgeColor = 'none';
shading interp
box on

ax = gca;
ax.FontName = fontName;
ax.FontSize = 16;
ax.LineWidth = 1;
ax.Layer = 'top';

xl = xlabel('Wavelength, \lambda (\mum)', 'FontName', fontName, 'FontSize', 20);
yl = ylabel('Electric Field\times10^8 (V/m)', 'FontName', fontName, 'FontSize', 20);
zl = zlabel('Responsivity, R (A/W)', 'FontName', fontName, 'FontSize', 20);

% Make X/Y labels align with their axes (like Z)
xl.RotationMode = 'auto';
yl.RotationMode = 'auto';
xl.HorizontalAlignment = 'center';
yl.HorizontalAlignment = 'center';

% keep your original viewing commands
xl.Rotation = 20;
yl.Rotation = -20;
view(45, 25);
camorbit(270, 0, 'data', [0 0 1]);   % match reference snippet rotation

grid off;

cb = colorbar;
cb.FontName = fontName;
cb.FontSize = 16;
cb.LineWidth = 1;
cb.Position(1) = cb.Position(1) - 0.05;

% ---- decrease both width and height ----
scaleW = 0.7;   % smaller = thinner
scaleH = 0.35;  % smaller = shorter

% width (keep right edge fixed)
oldW = cb.Position(3);
cb.Position(3) = oldW * scaleW;
cb.Position(1) = cb.Position(1) + (oldW - cb.Position(3));

% height (keep vertically centered)
oldH = cb.Position(4);
cb.Position(4) = oldH * scaleH;
cb.Position(2) = cb.Position(2) + (oldH - cb.Position(4))/2;

% ---- decrease colorbar width (extra thinning) ----
scaleW2 = 0.6;                         % 1 = original, smaller = thinner
oldW2   = cb.Position(3);
cb.Position(3) = oldW2 * scaleW2;
cb.Position(1) = cb.Position(1) + (oldW2 - cb.Position(3));  % keep right edge fixed

set(findall(gcf,'Type','text'),'FontName',fontName);

%% Export (vector PDF)
set(gcf,'Renderer','painters');
exportgraphics(gcf, 'Responsivity_3D_Surface.pdf', 'ContentType', 'vector');
